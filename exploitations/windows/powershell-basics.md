# PowerShell Basics

## Powershell: 

| Command name | Alias | Description |
| :--- | :--- | :--- |
| Set-Location | cd, chdir, sl | Sets the current working location to a specified location. |
| Get-Content | cat, gc, type | Gets the content of the item at the specified location. |
| Add-Content | ac | Adds content to the specified items, such as adding words to a file. |
| Set-Content | sc | Writes or replaces the content in an item with new content. |
| Copy-Item | copy, cp, cpi | Copies an item from one location to another. |
| Remove-Item | del, erase, rd, ri, rm, rmdir | Deletes the specified items. |
| Move-Item | mi, move, mv | Moves an item from one location to another. |
| Set-Item | si | Changes the value of an item to the value specified in the command. |
| New-Item | ni | Creates a new item. |
| Start-Job | sajb | Starts a Windows PowerShell background job. |
| Compare-Object | compare, dif | Compares two sets of objects. |
| Group-Object | group | Groups objects that contain the same value for specified properties. |
| Invoke-WebRequest | curl, iwr, wget | Gets content from a web page on the Internet. |
| Measure-Object | measure | Calculates the numeric properties of objects, and the characters, words, and lines in string objects, such as files … |
| Resolve-Path | rvpa | Resolves the wildcard characters in a path, and displays the path contents. |
| Resume-Job | rujb | Restarts a suspended job |
| Set-Variable | set, sv | Sets the value of a variable. Creates the variable if one with the requested name does not exist. |
| Show-Command | shcm | Creates Windows PowerShell commands in a graphical command window. |
| Sort-Object | sort | Sorts objects by property values. |
| Start-Service | sasv | Starts one or more stopped services. |
| Start-Process | saps, start | Starts one or more processes on the local computer. |
| Suspend-Job | sujb | Temporarily stops workflow jobs. |
| Wait-Job | wjb | Suppresses the command prompt until one or all of the Windows PowerShell background jobs running in the session are … |
| Where-Object | ?, where | Selects objects from a collection based on their property values. |
| Write-Output | echo, write | Sends the specified objects to the next command in the pipeline. If the command is the last command in the pipeline,… |

### The Essential PowerShell Commands

#### Get-Help

This command should be at the very top of any new user’s list when it comes to PowerShell. The Get-Help command can be used to literally get help with any other PowerShell command. For example, if you know the name of a command, but you don’t know what it does or how to use it, the Get-Help command provides the full command syntax.

For example, if you wanted to see how Get-Process works, you would type:

```text
PS C:\> Get-Help -Name Get-Process
```

```text
PS C:\> Set-ExecutionPolicy
```

As touched on earlier in this guide, Microsoft has a restricted execution policy that prevents scripting on PowerShell unless you change it. When setting the execution policy, you have four options to choose from:

* **Restricted** – The default execution policy that stops scripts from running.
* **All Signed** – Will run scripts if they are signed by a trusted publisher
* **Remote Signed** – Allows scripts to run which have been created locally
* **Unrestricted** – A policy with no restrictions on running scripts

```text
PS C:\> Get-ExecutionPolicy
```

If you’re using PowerShell, you may not always work on a server that you’re familiar with. Running the command **Get-Execution Policy** will allow you to see which policy is active on the server before running a new script. If you then see the server in question operating under a restricted policy, you can then implement the **Set-ExecutionPolicy** command to change it.

#### Get-Service

One of the most important commands is `Get-Service`, which provides the user with a list of all services installed on the system, both running and stopped. This cmdlet can be directed by using specific service names or objects.

For example, if you were to type `PS C:\> Get-Service`, you would be shown a list of all services on your computer, their statuses, and display names.

To use this command to retrieve specific services, type: `PS C:\ Get-Service “WMI*”` to retrieve all services that begin with WMI.

If you wanted to restrict output to active services on your computer, input the following command:

```text
PS C:\ Get-Service | Where-Object {$_.Status -eq “Running”}
```

#### ConvertTo-HTML

When using PowerShell, you might want to generate a report about the information you’ve seen. One of the best ways to do this is by using the **ConvertTo-HTML** command. This cmdlet allows you to build reports with tables and color, which can help to visualize complex data. Simply choose an object and add it to the command. For example, you could type:

```text
Get-PSDrive | ConvertTo-Html
```

This returns a mass of information, so it’s a good idea to limit it to a file with the Out-File command. A better alternative command is:

```text
Get-PSD Drive | ConvertTo-Html | Out-File -FilePath PSDrives.html
```

This will then generate an HTML file in table form. For example:

[![powershell html table](https://cdn.comparitech.com/wp-content/uploads/2018/05/HTML-table.jpg)](https://cdn.comparitech.com/wp-content/uploads/2018/05/HTML-table.jpg)

You can then add your own colors and borders to refine its presentation.

#### Export-CSV \(and Get-Service\)

No less important for increasing visibility is the Export-CSV command. It allows you to export PowerShell data into a CSV file. Essentially, this command creates a CSV file compiling all of the objects you’ve selected in PowerShell. Every object has its own line or row within the CSV file. This command is primarily used to create spreadsheets and share data with external programs.

To use this command, you would type:

```text
PS C:\> Get-Service | Export-CSV c:\service.csv
```

It’s important to remember not to format objects before running the Export-CSV command. This is because formatting objects results in only the formatted properties being placed into the CSV file rather than the original objects themselves. In the event that you want to send specific properties of an object to a CSV file, you would use the **Select-Object** cmdlet.

To use the **Select-Object** cmdlet, type:

```text
PS C:\> Get-Service | Select-Object Name, Status | Export-CSV c:\Service.csv
```

#### Get-Process

If you want to view all processes currently running on your system, the **Get-Process** command is very important. To get a list of all active processes on your computer, type:

```text
PS C:\ Get-Process
```

Notice that if you don’t specify any parameters, you’ll get a breakdown of every active process on your computer. To pick a specific process, narrow the results down by process name or process ID and combine that with the **Format-List** cmdlet, which displays all available properties. For example:

```text
PS C:\ Get-Process windowrd, explorer | Format-List *
```

This provides you with comprehensive oversight of all active processes.

#### Get-EventLog

[![get eventlog security cmdlet](https://cdn.comparitech.com/wp-content/uploads/2018/05/get-eventlog-security-cmdlet.jpg)](https://cdn.comparitech.com/wp-content/uploads/2018/05/get-eventlog-security-cmdlet.jpg)

If you ever want to access your computer’s event logs \(or logs on remote computers\) while using PowerShell, then you’re going to need the **Get-EventLog** command. This cmdlet only works on classic event logs, so you’ll need the **Get-WinEvent** command for logs later than Windows Vista.

To run the event log command, type:

```text
PS C:\> Get-EventLog -List
```

This will show all event logs on your computer.

One of the most common reasons users look at event logs is to see errors. If you want to see error events in your log, simply type:

```text
PS C:\> Get-EventLog -LogName System -EntryType Error
```

If you want to get event logs from multiple computers, specify which devices you want to view \(listed below as “Server1” and “Server2”\). For example:

```text
PS C:\> Get-EventLog - LogName “Windows PowerShell” -ComputerName “local computer”, “Server1”, “Server2”.
```

Parameters you can use to search event logs include:

* **After** – User specifies a date and time and the cmdlet will locate events that occurred after
* **AsBaseObject** – Provides a System.Diagnostics.EventLogEntry for each event
* **AsString** – Returns the output as strings
* **Before** – User specifies a date and time and the cmdlet will locate events that occurred before
* **ComputerName** – Used to refer to a remote computer
* **EntryType** – Specifies the entry type of events \(Error, Failure Audit, Success Audit, Information, Warning\)
* **Index** – Specifies index values the cmdlet finds events from
* **List** – Provides a list of event logs
* **UserName** – Specifies usernames associated with a given event

#### Stop-Process

[![powershell stop-process](https://cdn.comparitech.com/wp-content/uploads/2018/05/stop-process.jpg)](https://cdn.comparitech.com/wp-content/uploads/2018/05/stop-process.jpg)

When using PowerShell, it’s not uncommon to experience a process freezing up. Whenever this happens, you can use **Get-Process** to retrieve the name of the process experiencing difficulties and then stop it with the **Stop-Process** command. Generally, you terminate a process by its name. For example:

```text
PS C:\> Stop-Process -Name “notepad”
```

In this example, the user has terminated Notepad by using the `Stop-Process` command.

[https://www.comparitech.com/net-admin/powershell-cheat-sheet/](https://www.comparitech.com/net-admin/powershell-cheat-sheet/)

